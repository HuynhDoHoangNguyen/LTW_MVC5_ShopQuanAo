/* ===========================================================
    TẠO DATABASE
=========================================================== */
SET DATEFORMAT DMY
IF DB_ID('QL_ShopQuanAoNu') IS NOT NULL
    DROP DATABASE QL_ShopQuanAoNu
GO

CREATE DATABASE QL_ShopQuanAoNu
ON PRIMARY (
    NAME = N'QL_ShopQuanAoNu',
    FILENAME = 'D:\University\HK1 (2025-2026)\Web_Development\DoAnCuoiMon\LTW_MVC5_ShopQuanAo\QLShopQuanAoNu.mdf',
    SIZE = 50MB,
    MAXSIZE = 300MB,
    FILEGROWTH = 5%
)
LOG ON (
    NAME = N'QL_ShopQuanAoNu_LOG',
    FILENAME = 'D:\University\HK1 (2025-2026)\Web_Development\DoAnCuoiMon\LTW_MVC5_ShopQuanAo\QLShopQuanAoNu.ldf',
    SIZE = 10MB,
    MAXSIZE = 200MB,
    FILEGROWTH = 5%
)
GO

USE QL_ShopQuanAoNu
GO


/* ===========================================================
    SEQUENCE thêm vào để không phải nhập mã các bảng mà tự động
=========================================================== */
CREATE SEQUENCE SEQ_DM START WITH 1 INCREMENT BY 1
CREATE SEQUENCE SEQ_SP START WITH 1 INCREMENT BY 1
CREATE SEQUENCE SEQ_MAU START WITH 1 INCREMENT BY 1
CREATE SEQUENCE SEQ_SIZE START WITH 1 INCREMENT BY 1
CREATE SEQUENCE SEQ_NCC START WITH 1 INCREMENT BY 1
CREATE SEQUENCE SEQ_KH START WITH 1 INCREMENT BY 1
CREATE SEQUENCE SEQ_PN START WITH 1 INCREMENT BY 1
CREATE SEQUENCE SEQ_DH START WITH 1 INCREMENT BY 1
CREATE SEQUENCE SEQ_HINH START WITH 1 INCREMENT BY 1
CREATE SEQUENCE SEQ_VT START WITH 1 INCREMENT BY 1
CREATE SEQUENCE SEQ_GH START WITH 1 INCREMENT BY 1
GO


/* ===========================================================
    BẢNG CHÍNH
=========================================================== */
CREATE TABLE DANH_MUC (
    MADM VARCHAR(10) PRIMARY KEY DEFAULT ('DM' + RIGHT('00' + CAST(NEXT VALUE FOR SEQ_DM AS VARCHAR),2)),
    TENDM NVARCHAR(100) UNIQUE NOT NULL,
    TRANGTHAI BIT DEFAULT 1
)

CREATE TABLE SAN_PHAM (
    MASP VARCHAR(10) PRIMARY KEY DEFAULT ('SP' + RIGHT('000' + CAST(NEXT VALUE FOR SEQ_SP AS VARCHAR),3)),
    TENSP NVARCHAR(200) UNIQUE NOT NULL,
    MADM VARCHAR(10) FOREIGN KEY REFERENCES DANH_MUC(MADM),
    MOTA NVARCHAR(MAX),
    SOLUONGTON INT DEFAULT 0,
    TRANGTHAI BIT DEFAULT 1
)

CREATE TABLE MAU_SAC (
    MAMAU VARCHAR(10) PRIMARY KEY DEFAULT ('M' + RIGHT('00' + CAST(NEXT VALUE FOR SEQ_MAU AS VARCHAR),2)),
    TENMAU NVARCHAR(50) UNIQUE NOT NULL,
    TRANGTHAI BIT DEFAULT 1
)

CREATE TABLE KICH_THUOC (
    MASIZE VARCHAR(10) PRIMARY KEY DEFAULT ('SZ' + RIGHT('00' + CAST(NEXT VALUE FOR SEQ_SIZE AS VARCHAR),2)),
    TENSIZE NVARCHAR(20) UNIQUE NOT NULL,
    TRANGTHAI BIT DEFAULT 1
)

CREATE TABLE CHI_TIET_SP (
    MASP VARCHAR(10),
    MAMAU VARCHAR(10),
    MASIZE VARCHAR(10),
    MACTSP AS (MASP + MAMAU + MASIZE) PERSISTED UNIQUE,
    SOLUONGTON INT DEFAULT 0,
    GIANHAP DECIMAL(18,3),
    GIABAN DECIMAL(18,3),
    TRANGTHAI BIT DEFAULT 1,
    PRIMARY KEY (MASP, MAMAU, MASIZE),
    FOREIGN KEY (MASP) REFERENCES SAN_PHAM(MASP),
    FOREIGN KEY (MAMAU) REFERENCES MAU_SAC(MAMAU),
    FOREIGN KEY (MASIZE) REFERENCES KICH_THUOC(MASIZE)
)

CREATE TABLE HINH_ANH_SP (
    MAHINH VARCHAR(10) PRIMARY KEY DEFAULT ('H' + RIGHT('000' + CAST(NEXT VALUE FOR SEQ_HINH AS VARCHAR),3)),
    MASP VARCHAR(10) FOREIGN KEY REFERENCES SAN_PHAM(MASP),
    TENHINHANH NVARCHAR(200),
    TRANGTHAI BIT DEFAULT 1
)


/* ===========================================================
    NHÀ CUNG CẤP + NHẬP HÀNG
=========================================================== */
CREATE TABLE NHA_CUNG_CAP (
    MANCC VARCHAR(10) PRIMARY KEY DEFAULT ('NCC' + RIGHT('00' + CAST(NEXT VALUE FOR SEQ_NCC AS VARCHAR),2)),
    TENNCC NVARCHAR(200),
    SDT VARCHAR(15),
    DIACHI NVARCHAR(200),
    TRANGTHAI BIT DEFAULT 1
)

CREATE TABLE PHIEU_NHAP (
    MAPN VARCHAR(10) PRIMARY KEY DEFAULT ('PN' + RIGHT('0000' + CAST(NEXT VALUE FOR SEQ_PN AS VARCHAR),4)),
    MANCC VARCHAR(10) FOREIGN KEY REFERENCES NHA_CUNG_CAP(MANCC),
    NGAYLAP DATE DEFAULT GETDATE(),
    TONGSOLUONG INT DEFAULT 0,
    TONGTHANHTIEN DECIMAL(18,3) DEFAULT 0,
    GHICHU NVARCHAR(200),
    TRANGTHAI BIT DEFAULT 1
)

CREATE TABLE CT_PHIEU_NHAP (
    MAPN VARCHAR(10),
    MASP VARCHAR(10),
    MAMAU VARCHAR(10),
    MASIZE VARCHAR(10),
    MACTPN AS (MAPN + MASP + MAMAU + MASIZE) PERSISTED UNIQUE,
    SOLUONG INT,
    DONGIANHAP DECIMAL(18,3),
    THANHTIEN DECIMAL(18,3),
    PRIMARY KEY (MAPN, MASP, MAMAU, MASIZE),
    FOREIGN KEY (MAPN) REFERENCES PHIEU_NHAP(MAPN),
    FOREIGN KEY (MASP, MAMAU, MASIZE) REFERENCES CHI_TIET_SP(MASP, MAMAU, MASIZE)
)


/* ===========================================================
    KHÁCH HÀNG / ĐƠN HÀNG
=========================================================== */
CREATE TABLE KHACH_HANG (
    MAKH VARCHAR(10) PRIMARY KEY DEFAULT ('KH' + RIGHT('0000' + CAST(NEXT VALUE FOR SEQ_KH AS VARCHAR),4)),
    HOTEN NVARCHAR(200),
    SDT VARCHAR(15) UNIQUE,
    EMAIL NVARCHAR(200) UNIQUE,
    DIACHI NVARCHAR(200),
    USERNAME VARCHAR(50) UNIQUE NULL,
    TRANGTHAI BIT DEFAULT 1
)

CREATE TABLE DON_HANG (
    MADH VARCHAR(10) PRIMARY KEY DEFAULT ('DH' + RIGHT('0000' + CAST(NEXT VALUE FOR SEQ_DH AS VARCHAR),4)),
    MAKH VARCHAR(10) FOREIGN KEY REFERENCES KHACH_HANG(MAKH),
    NGAYDAT DATE DEFAULT GETDATE(),
    HINHTHUCTHANHTOAN NVARCHAR(50) DEFAULT N'COD',
    DIACHIGIAO NVARCHAR(200),
    GIAMGIA INT DEFAULT 0,
    TONGSOLUONG INT DEFAULT 0,
    TONGTHANHTIEN DECIMAL(18,3) DEFAULT 0,
    TRANGTHAI BIT DEFAULT 1
)

CREATE TABLE CT_DON_HANG (
    MADH VARCHAR(10),
    MASP VARCHAR(10),
    MAMAU VARCHAR(10),
    MASIZE VARCHAR(10),
    MACTDH AS (MADH + MASP + MAMAU + MASIZE) PERSISTED UNIQUE,
    SOLUONG INT,
    GIALUCBAN DECIMAL(18,3),
    THANHTIEN DECIMAL(18,3),
    PRIMARY KEY (MADH, MASP, MAMAU, MASIZE),
    FOREIGN KEY (MADH) REFERENCES DON_HANG(MADH),
    FOREIGN KEY (MASP, MAMAU, MASIZE) REFERENCES CHI_TIET_SP(MASP, MAMAU, MASIZE)
)


/* ===========================================================
    PHÂN QUYỀN
=========================================================== */
CREATE TABLE VAI_TRO (
    MAVT VARCHAR(10) PRIMARY KEY DEFAULT ('VT' + RIGHT('00' + CAST(NEXT VALUE FOR SEQ_VT AS VARCHAR),2)),
    TENVAI NVARCHAR(50) UNIQUE
)

CREATE TABLE TAI_KHOAN (
    USERNAME VARCHAR(50) PRIMARY KEY,
    MATKHAU VARCHAR(200),
    MAVT VARCHAR(10) FOREIGN KEY REFERENCES VAI_TRO(MAVT),
    TRANGTHAI BIT DEFAULT 1
)

CREATE TABLE GIO_HANG (
    MAGH VARCHAR(10) PRIMARY KEY DEFAULT ('GH' + RIGHT('0000' + CAST(NEXT VALUE FOR SEQ_GH AS VARCHAR),4)),
    USERNAME VARCHAR(50) NOT NULL UNIQUE,
    NGAYTAO DATETIME DEFAULT GETDATE(),
    TRANGTHAI BIT DEFAULT 1,

    FOREIGN KEY (USERNAME) REFERENCES TAI_KHOAN(USERNAME)
)


CREATE TABLE CT_GIO_HANG (
    MAGH VARCHAR(10) NOT NULL,
    MASP VARCHAR(10) NOT NULL,
    MAMAU VARCHAR(10) NOT NULL,
    MASIZE VARCHAR(10) NOT NULL,
    SOLUONG INT DEFAULT 1,

    PRIMARY KEY (MAGH, MASP, MAMAU, MASIZE),

    FOREIGN KEY (MAGH) REFERENCES GIO_HANG(MAGH),
    FOREIGN KEY (MASP, MAMAU, MASIZE) REFERENCES CHI_TIET_SP(MASP, MAMAU, MASIZE)
)




/* ===========================================================
    TRIGGER: CẬP NHẬT TỒN + GIÁ
=========================================================== */
-- Nhập hàng
GO
CREATE TRIGGER TG_CTPN ON CT_PHIEU_NHAP
AFTER INSERT,UPDATE
AS
BEGIN
    UPDATE CT SET THANHTIEN = I.SOLUONG * I.DONGIANHAP
    FROM CT_PHIEU_NHAP CT JOIN INSERTED I
    ON CT.MAPN=I.MAPN AND CT.MASP=I.MASP AND CT.MAMAU=I.MAMAU AND CT.MASIZE=I.MASIZE

    UPDATE SP SET 
        SP.SOLUONGTON = SP.SOLUONGTON + I.SOLUONG,
        SP.GIANHAP = I.DONGIANHAP,
        SP.GIABAN = I.DONGIANHAP * 1.5
    FROM CHI_TIET_SP SP JOIN INSERTED I
    ON SP.MASP=I.MASP AND SP.MAMAU=I.MAMAU AND SP.MASIZE=I.MASIZE

    UPDATE P SET 
        TONGSOLUONG = (SELECT SUM(SOLUONG) FROM CT_PHIEU_NHAP WHERE MAPN=P.MAPN),
        TONGTHANHTIEN = (SELECT SUM(THANHTIEN) FROM CT_PHIEU_NHAP WHERE MAPN=P.MAPN)
    FROM PHIEU_NHAP P JOIN INSERTED I ON P.MAPN=I.MAPN
END
GO

-- Bán hàng
GO
CREATE TRIGGER TG_CTDH ON CT_DON_HANG
AFTER INSERT,UPDATE
AS
BEGIN
    UPDATE CT SET GIALUCBAN = S.GIABAN * 1.3
    FROM CT_DON_HANG CT JOIN INSERTED I
    ON CT.MADH=I.MADH AND CT.MASP=I.MASP AND CT.MAMAU=I.MAMAU AND CT.MASIZE=I.MASIZE
    JOIN CHI_TIET_SP S ON S.MASP=I.MASP AND S.MAMAU=I.MAMAU AND S.MASIZE=I.MASIZE
    WHERE CT.GIALUCBAN IS NULL

    UPDATE CT SET THANHTIEN = CT.SOLUONG * CT.GIALUCBAN
    FROM CT_DON_HANG CT JOIN INSERTED I
    ON CT.MADH=I.MADH AND CT.MASP=I.MASP AND CT.MAMAU=I.MAMAU AND CT.MASIZE=I.MASIZE

    UPDATE SP SET SP.SOLUONGTON = SP.SOLUONGTON - I.SOLUONG
    FROM CHI_TIET_SP SP JOIN INSERTED I
    ON SP.MASP=I.MASP AND SP.MAMAU=I.MAMAU AND SP.MASIZE=I.MASIZE

    IF EXISTS (SELECT * FROM CHI_TIET_SP WHERE SOLUONGTON < 0)
    BEGIN
        RAISERROR(N'Tồn kho không đủ!',16,1)
        ROLLBACK TRANSACTION
        RETURN
    END

    UPDATE D SET 
        TONGSOLUONG = (SELECT SUM(SOLUONG) FROM CT_DON_HANG WHERE MADH=D.MADH),
        GIAMGIA = CASE WHEN (SELECT SUM(SOLUONG) FROM CT_DON_HANG WHERE MADH=D.MADH) >=10 THEN 7
                       WHEN (SELECT SUM(SOLUONG) FROM CT_DON_HANG WHERE MADH=D.MADH) >=5 THEN 5
                       ELSE 0 END,
        TONGTHANHTIEN =
            (SELECT SUM(THANHTIEN) FROM CT_DON_HANG WHERE MADH=D.MADH)
            *(1-D.GIAMGIA/100.0)
    FROM DON_HANG D JOIN INSERTED I ON D.MADH=I.MADH
END
GO


/* ===========================================================
    STORED PROCEDURE: ĐĂNG KÝ, ĐĂNG NHẬP, Giỏ hàng
=========================================================== */
--đăng kí
GO
CREATE PROCEDURE SP_DANGKY
    @USER VARCHAR(50), @PASS VARCHAR(200),
    @HOTEN NVARCHAR(200), @EMAIL NVARCHAR(200), @SDT VARCHAR(15), @DIACHI NVARCHAR(200)
AS
BEGIN
    DECLARE @MAKH VARCHAR(10) = 'KH' + RIGHT('0000'+CAST(NEXT VALUE FOR SEQ_KH AS VARCHAR),4)

    INSERT INTO TAI_KHOAN VALUES (@USER,@PASS,'VT02',1)
    INSERT INTO KHACH_HANG VALUES (@MAKH,@HOTEN,@SDT,@EMAIL,@DIACHI,@USER,1)
END
GO
-- đăng nhập
CREATE PROCEDURE SP_DANGNHAP @USER VARCHAR(50), @PASS VARCHAR(200)
AS
BEGIN
    SELECT TK.USERNAME, VT.TENVAI
    FROM TAI_KHOAN TK JOIN VAI_TRO VT ON TK.MAVT=VT.MAVT
    WHERE TK.USERNAME=@USER AND TK.MATKHAU=@PASS AND TK.TRANGTHAI=1
END
GO

--thêm giỏ hàng
GO
CREATE PROCEDURE SP_GH_ADD
    @USERNAME VARCHAR(50),
    @MASP VARCHAR(10),
    @MAMAU VARCHAR(10),
    @MASIZE VARCHAR(10),
    @SOLUONG INT
AS
BEGIN
    DECLARE @MAGH VARCHAR(10);

    -- Lấy giỏ của user
    SELECT @MAGH = MAGH FROM GIO_HANG WHERE USERNAME = @USERNAME;

    -- Nếu chưa có -> tạo mới
    IF @MAGH IS NULL
    BEGIN
        SET @MAGH = 'GH' + RIGHT('0000' + CAST(NEXT VALUE FOR SEQ_GH AS VARCHAR),4);
        INSERT INTO GIO_HANG (MAGH,USERNAME) VALUES (@MAGH, @USERNAME);
    END

    -- Nếu sản phẩm tồn tại -> tăng số lượng
    IF EXISTS (
        SELECT 1 FROM CT_GIO_HANG 
        WHERE MAGH=@MAGH AND MASP=@MASP AND MAMAU=@MAMAU AND MASIZE=@MASIZE
    )
    BEGIN
        UPDATE CT_GIO_HANG
        SET SOLUONG = SOLUONG + @SOLUONG
        WHERE MAGH=@MAGH AND MASP=@MASP AND MAMAU=@MAMAU AND MASIZE=@MASIZE;
    END
    ELSE
    BEGIN
        INSERT INTO CT_GIO_HANG (MAGH, MASP, MAMAU, MASIZE, SOLUONG)
        VALUES (@MAGH, @MASP, @MAMAU, @MASIZE, @SOLUONG);
    END
END
GO


/* ===========================================================
    SEARCH + CATEGORY API
=========================================================== */

CREATE PROCEDURE SP_SP_TIMKIEM @KEY NVARCHAR(200)
AS
BEGIN
    SELECT MASP,TENSP,SOLUONGTON FROM SAN_PHAM
    WHERE TENSP LIKE '%'+@KEY+'%'
END
GO

CREATE PROCEDURE SP_DM_LIST AS SELECT * FROM DANH_MUC
GO

CREATE PROCEDURE SP_DM_ADD @TEN NVARCHAR(100)
AS INSERT INTO DANH_MUC(TENDM) VALUES(@TEN)
GO

CREATE PROCEDURE SP_DM_UPDATE @MADM VARCHAR(10), @TEN NVARCHAR(100), @TT BIT
AS UPDATE DANH_MUC SET TENDM=@TEN,TRANGTHAI=@TT WHERE MADM=@MADM
GO

CREATE PROCEDURE SP_DM_DELETE @MADM VARCHAR(10)
AS
BEGIN
    IF EXISTS(SELECT 1 FROM SAN_PHAM WHERE MADM=@MADM)
        UPDATE DANH_MUC SET TRANGTHAI=0 WHERE MADM=@MADM
    ELSE
        DELETE FROM DANH_MUC WHERE MADM=@MADM
END
GO

---------------------thêm dữ liệu mẫu -------------------------
INSERT INTO DANH_MUC(TENDM) VALUES
(N'Áo'),(N'Sơ mi'),(N'Chân váy'),(N'Đầm'),
(N'Đồ ngủ'),(N'Hoodie'),(N'Áo khoác'),
(N'Quần jean'),(N'Quần short'),(N'Yếm denim')


INSERT INTO MAU_SAC(TENMAU) VALUES 
(N'Đen'),(N'Trắng'),(N'Kem')

INSERT INTO KICH_THUOC(TENSIZE) VALUES (N'S'),(N'M'),(N'L')

INSERT INTO SAN_PHAM(TENSP, MADM, MOTA) VALUES
(N'Áo thun basic cotton','DM01',N'Cotton form rộng'),
(N'Áo sơ mi tay dài nữ','DM02',N'Sơ mi công sở'),
(N'Chân váy chữ A','DM03',N'Dáng A, tuyết mưa'),
(N'Đầm công sở body','DM04',N'Body sang trọng'),
(N'Đồ ngủ pijama nữ','DM05',N'Cotton mềm'),
(N'Hoodie oversize nữ','DM06',N'Nỉ bông'),
(N'Áo khoác bomber nữ','DM07',N'Kaki mềm'),
(N'Quần jean skinny nữ','DM08',N'Co giãn 4 chiều'),
(N'Quần short kaki nữ','DM09',N'Kaki co giãn'),
(N'Yếm váy denim nữ','DM10',N'Denim cá tính')


-- them các chi tiết sp
INSERT INTO CHI_TIET_SP(MASP,MAMAU,MASIZE, SOLUONGTON) VALUES
-- SP001
('SP001','M01','SZ01',0),('SP001','M01','SZ02',0),('SP001','M01','SZ03',0),
('SP001','M02','SZ01',0),('SP001','M02','SZ02',0),('SP001','M02','SZ03',0),
('SP001','M03','SZ01',0),('SP001','M03','SZ02',0),('SP001','M03','SZ03',0),

-- SP002
('SP002','M01','SZ01',0),('SP002','M01','SZ02',0),('SP002','M01','SZ03',0),
('SP002','M02','SZ01',0),('SP002','M02','SZ02',0),('SP002','M02','SZ03',0),
('SP002','M03','SZ01',0),('SP002','M03','SZ02',0),('SP002','M03','SZ03',0),

-- SP003
('SP003','M01','SZ01',0),('SP003','M01','SZ02',0),('SP003','M01','SZ03',0),
('SP003','M02','SZ01',0),('SP003','M02','SZ02',0),('SP003','M02','SZ03',0),
('SP003','M03','SZ01',0),('SP003','M03','SZ02',0),('SP003','M03','SZ03',0),

-- SP004
('SP004','M01','SZ01',0),('SP004','M01','SZ02',0),('SP004','M01','SZ03',0),
('SP004','M02','SZ01',0),('SP004','M02','SZ02',0),('SP004','M02','SZ03',0),
('SP004','M03','SZ01',0),('SP004','M03','SZ02',0),('SP004','M03','SZ03',0),

-- SP005
('SP005','M01','SZ01',0),('SP005','M01','SZ02',0),('SP005','M01','SZ03',0),
('SP005','M02','SZ01',0),('SP005','M02','SZ02',0),('SP005','M02','SZ03',0),
('SP005','M03','SZ01',0),('SP005','M03','SZ02',0),('SP005','M03','SZ03',0),

-- SP006
('SP006','M01','SZ01',0),('SP006','M01','SZ02',0),('SP006','M01','SZ03',0),
('SP006','M02','SZ01',0),('SP006','M02','SZ02',0),('SP006','M02','SZ03',0),
('SP006','M03','SZ01',0),('SP006','M03','SZ02',0),('SP006','M03','SZ03',0),

-- SP007
('SP007','M01','SZ01',0),('SP007','M01','SZ02',0),('SP007','M01','SZ03',0),
('SP007','M02','SZ01',0),('SP007','M02','SZ02',0),('SP007','M02','SZ03',0),
('SP007','M03','SZ01',0),('SP007','M03','SZ02',0),('SP007','M03','SZ03',0),

-- SP008
('SP008','M01','SZ01',0),('SP008','M01','SZ02',0),('SP008','M01','SZ03',0),
('SP008','M02','SZ01',0),('SP008','M02','SZ02',0),('SP008','M02','SZ03',0),
('SP008','M03','SZ01',0),('SP008','M03','SZ02',0),('SP008','M03','SZ03',0),

-- SP009
('SP009','M01','SZ01',0),('SP009','M01','SZ02',0),('SP009','M01','SZ03',0),
('SP009','M02','SZ01',0),('SP009','M02','SZ02',0),('SP009','M02','SZ03',0),
('SP009','M03','SZ01',0),('SP009','M03','SZ02',0),('SP009','M03','SZ03',0),

-- SP010
('SP010','M01','SZ01',0),('SP010','M01','SZ02',0),('SP010','M01','SZ03',0),
('SP010','M02','SZ01',0),('SP010','M02','SZ02',0),('SP010','M02','SZ03',0),
('SP010','M03','SZ01',0),('SP010','M03','SZ02',0),('SP010','M03','SZ03',0)

INSERT INTO NHA_CUNG_CAP(TENNCC,SDT,DIACHI) VALUES
(N'Fashion Supplier','0988001122',N'Hà Nội'),
(N'Saigon Clothes Co','0909123456',N'HCM')


INSERT INTO PHIEU_NHAP (MANCC, GHICHU) VALUES
('NCC01',N'Nhập đầu kho'),
('NCC01',N'Nhập bổ sung'),
('NCC02',N'Nhập hàng đợt 3'),
('NCC02',N'Nhập hàng Tết')


--phiếu nhập 1
INSERT INTO CT_PHIEU_NHAP VALUES
('PN0001','SP001','M01','SZ01',50,300000,NULL),
('PN0001','SP001','M01','SZ02',40,320000,NULL),
('PN0001','SP001','M01','SZ03',35,310000,NULL),
('PN0001','SP001','M02','SZ01',45,330000,NULL),
('PN0001','SP001','M02','SZ02',40,315000,NULL),
('PN0001','SP001','M02','SZ03',30,305000,NULL),
('PN0001','SP001','M03','SZ01',50,300000,NULL),
('PN0001','SP001','M03','SZ02',45,340000,NULL),
('PN0001','SP001','M03','SZ03',38,350000,NULL),

('PN0001','SP002','M01','SZ01',30,400000,NULL),
('PN0001','SP002','M01','SZ02',25,420000,NULL),
('PN0001','SP002','M01','SZ03',20,430000,NULL),
('PN0001','SP002','M02','SZ01',28,410000,NULL),
('PN0001','SP002','M02','SZ02',26,435000,NULL),
('PN0001','SP002','M02','SZ03',24,445000,NULL),
('PN0001','SP002','M03','SZ01',32,380000,NULL),
('PN0001','SP002','M03','SZ02',30,390000,NULL),
('PN0001','SP002','M03','SZ03',28,395000,NULL),

('PN0001','SP003','M01','SZ01',40,350000,NULL),
('PN0001','SP003','M01','SZ02',35,355000,NULL),
('PN0001','SP003','M01','SZ03',30,360000,NULL),
('PN0001','SP003','M02','SZ01',38,370000,NULL)


---phiêu nhập 2
INSERT INTO CT_PHIEU_NHAP VALUES
('PN0002','SP003','M02','SZ02',36,380000,NULL),
('PN0002','SP003','M02','SZ03',34,390000,NULL),
('PN0002','SP003','M03','SZ01',40,400000,NULL),
('PN0002','SP003','M03','SZ02',35,395000,NULL),
('PN0002','SP003','M03','SZ03',33,405000,NULL),

('PN0002','SP004','M01','SZ01',20,500000,NULL),
('PN0002','SP004','M01','SZ02',18,520000,NULL),
('PN0002','SP004','M01','SZ03',16,540000,NULL),
('PN0002','SP004','M02','SZ01',22,550000,NULL),
('PN0002','SP004','M02','SZ02',20,560000,NULL),
('PN0002','SP004','M02','SZ03',19,580000,NULL),
('PN0002','SP004','M03','SZ01',24,590000,NULL),
('PN0002','SP004','M03','SZ02',22,600000,NULL),
('PN0002','SP004','M03','SZ03',20,620000,NULL),

('PN0002','SP005','M01','SZ01',30,350000,NULL),
('PN0002','SP005','M01','SZ02',28,360000,NULL),
('PN0002','SP005','M01','SZ03',27,370000,NULL),
('PN0002','SP005','M02','SZ01',32,365000,NULL),
('PN0002','SP005','M02','SZ02',30,375000,NULL),
('PN0002','SP005','M02','SZ03',28,380000,NULL),
('PN0002','SP005','M03','SZ01',35,390000,NULL),
('PN0002','SP005','M03','SZ02',33,400000,NULL)

---phiếu nhập 3
INSERT INTO CT_PHIEU_NHAP VALUES
('PN0003','SP005','M03','SZ03',32,395000,NULL),

('PN0003','SP006','M01','SZ01',45,420000,NULL),
('PN0003','SP006','M01','SZ02',42,430000,NULL),
('PN0003','SP006','M01','SZ03',40,440000,NULL),
('PN0003','SP006','M02','SZ01',48,450000,NULL),
('PN0003','SP006','M02','SZ02',44,460000,NULL),
('PN0003','SP006','M02','SZ03',42,470000,NULL),
('PN0003','SP006','M03','SZ01',50,480000,NULL),
('PN0003','SP006','M03','SZ02',48,490000,NULL),
('PN0003','SP006','M03','SZ03',45,500000,NULL),

('PN0003','SP007','M01','SZ01',25,600000,NULL),
('PN0003','SP007','M01','SZ02',24,620000,NULL),
('PN0003','SP007','M01','SZ03',23,640000,NULL),
('PN0003','SP007','M02','SZ01',26,660000,NULL),
('PN0003','SP007','M02','SZ02',25,670000,NULL),
('PN0003','SP007','M02','SZ03',24,680000,NULL),
('PN0003','SP007','M03','SZ01',28,690000,NULL),
('PN0003','SP007','M03','SZ02',26,700000,NULL),
('PN0003','SP007','M03','SZ03',25,720000,NULL),

('PN0003','SP008','M01','SZ01',35,450000,NULL),
('PN0003','SP008','M01','SZ02',34,460000,NULL),
('PN0003','SP008','M01','SZ03',32,465000,NULL)

--phiếu nhập 4 
INSERT INTO CT_PHIEU_NHAP VALUES
('PN0004','SP008','M02','SZ01',36,470000,NULL),
('PN0004','SP008','M02','SZ02',34,480000,NULL),
('PN0004','SP008','M02','SZ03',32,490000,NULL),
('PN0004','SP008','M03','SZ01',38,495000,NULL),
('PN0004','SP008','M03','SZ02',36,500000,NULL),
('PN0004','SP008','M03','SZ03',34,510000,NULL),

('PN0004','SP009','M01','SZ01',40,320000,NULL),
('PN0004','SP009','M01','SZ02',38,330000,NULL),
('PN0004','SP009','M01','SZ03',35,340000,NULL),
('PN0004','SP009','M02','SZ01',42,350000,NULL),
('PN0004','SP009','M02','SZ02',40,360000,NULL),
('PN0004','SP009','M02','SZ03',38,370000,NULL),
('PN0004','SP009','M03','SZ01',45,380000,NULL),
('PN0004','SP009','M03','SZ02',42,390000,NULL),
('PN0004','SP009','M03','SZ03',40,400000,NULL),

('PN0004','SP010','M01','SZ01',25,550000,NULL),
('PN0004','SP010','M01','SZ02',24,560000,NULL),
('PN0004','SP010','M01','SZ03',22,580000,NULL),
('PN0004','SP010','M02','SZ01',26,590000,NULL),
('PN0004','SP010','M02','SZ02',24,600000,NULL),
('PN0004','SP010','M02','SZ03',23,620000,NULL),
('PN0004','SP010','M03','SZ01',28,630000,NULL),
('PN0004','SP010','M03','SZ02',26,650000,NULL),
('PN0004','SP010','M03','SZ03',25,680000,NULL)


delete from KHACH_HANG
--khách hàng và tài khảon
INSERT INTO KHACH_HANG (HOTEN, SDT, EMAIL, DIACHI, USERNAME)
VALUES
(N'Lê Minh Thảo', '0903111222', 'thaole@gmail.com', N'Q1, HCM', 'user01'),
(N'Nguyễn Thái Hòa', '0912333444', 'hoa.nt@gmail.com', N'Q3, HCM', 'user02'),
(N'Trần Thị Mai', '0933444555', 'maitran@gmail.com', N'Tân Bình, HCM', 'user03'),
(N'Phạm Nhật Tân', '0988777666', 'tanpnhat@gmail.com', N'Bình Thạnh, HCM', 'user04'),
(N'Võ Anh Quân', '0902555666', 'quan.vo@gmail.com', N'Thủ Đức, HCM', 'user05'),
(N'Đỗ Hoàng Vy', '0966778899', 'vy.do@gmail.com', N'Hà Nội', 'user06'),
(N'Nguyễn Ngọc Hà', '0911888999', 'hanguyen@gmail.com', N'Hà Nội', 'user07'),
(N'Phan Thùy Trang', '0937788996', 'trangpth@gmail.com', N'Đà Nẵng', 'user08'),
(N'Vũ Minh Khoa', '0988555444', 'khoa.vu@gmail.com', N'Hải Phòng', 'user09'),
(N'Huỳnh Gia Hân', '0909777333', 'hanh.huynh@gmail.com', N'Cần Thơ', 'user10')


INSERT INTO VAI_TRO
VALUES
('VT01',N'admin'),
('VT02',N'user')

INSERT INTO TAI_KHOAN(USERNAME,MATKHAU,MAVT,TRANGTHAI)
VALUES
('user01','123456','VT02',1),
('user02','123456','VT02',1),
('user03','123456','VT02',1),
('user04','123456','VT02',1),
('user05','123456','VT02',1),
('user06','123456','VT02',1),
('user07','123456','VT02',1),
('user08','123456','VT02',1),
('user09','123456','VT02',1),
('user10','123456','VT02',1),
('admin','123456','VT01',1)


-- 20 đơn hàng 10 khách
INSERT INTO DON_HANG (MAKH, DIACHIGIAO, HINHTHUCTHANHTOAN)
VALUES
('KH0002', N'Q1, HCM', N'COD'),
('KH0003', N'Q3, HCM', N'BANK'),
('KH0004', N'Tân Bình, HCM', N'CASH'),
('KH0005', N'Bình Thạnh, HCM', N'COD'),
('KH0006', N'Thủ Đức, HCM', N'COD'),
('KH0007', N'Hà Nội', N'BANK'),
('KH0008', N'Hà Nội', N'CASH'),
('KH0009', N'Đà Nẵng', N'COD'),
('KH0010', N'Hải Phòng', N'CASH'),
('KH0010', N'Cần Thơ', N'COD'),
('KH0002', N'Q1, HCM', N'COD'),
('KH0003', N'Q3, HCM', N'BANK'),
('KH0004', N'Tân Bình, HCM', N'COD'),
('KH0005', N'Bình Thạnh, HCM', N'CASH'),
('KH0006', N'Thủ Đức, HCM', N'COD'),
('KH0007', N'Hà Nội', N'BANK'),
('KH0008', N'Hà Nội', N'CASH'),
('KH0009', N'Đà Nẵng', N'COD'),
('KH0010', N'Hải Phòng', N'COD'),
('KH0001', N'Cần Thơ', N'CASH')

--50 ctdh đơn hàng
INSERT INTO CT_DON_HANG (MADH, MASP, MAMAU, MASIZE, SOLUONG)
VALUES
('DH0002','SP001','M01','SZ01',2),
('DH0002','SP001','M02','SZ02',1),
('DH0003','SP002','M03','SZ01',1),
('DH0003','SP003','M01','SZ02',2),
('DH0004','SP004','M02','SZ03',1),
('DH0004','SP005','M01','SZ01',2),
('DH0005','SP006','M02','SZ01',1),
('DH0005','SP007','M03','SZ03',2),
('DH0006','SP008','M01','SZ02',3),
('DH0006','SP009','M02','SZ01',1),
('DH0007','SP010','M03','SZ02',2),
('DH0007','SP001','M01','SZ03',1),
('DH0008','SP002','M02','SZ02',2),
('DH0008','SP003','M03','SZ01',1),
('DH0009','SP004','M01','SZ03',1),
('DH0009','SP005','M02','SZ01',2),
('DH0010','SP006','M03','SZ02',2),
('DH0010','SP007','M01','SZ01',1),
('DH0011','SP008','M02','SZ02',3),
('DH0011','SP009','M03','SZ03',1),
('DH0012','SP010','M01','SZ01',2),
('DH0012','SP001','M02','SZ02',2),
('DH0013','SP002','M01','SZ03',1),
('DH0013','SP003','M03','SZ02',2),
('DH0014','SP004','M02','SZ01',1),
('DH0014','SP005','M01','SZ03',3),
('DH0015','SP006','M02','SZ02',1),
('DH0015','SP007','M03','SZ01',2),
('DH0016','SP008','M01','SZ03',1),
('DH0016','SP009','M02','SZ01',2),
('DH0017','SP010','M03','SZ02',1),
('DH0017','SP001','M01','SZ01',2),
('DH0018','SP002','M02','SZ02',1),
('DH0018','SP003','M03','SZ03',3),
('DH0019','SP004','M01','SZ02',2),
('DH0019','SP005','M02','SZ01',1),
('DH0020','SP006','M03','SZ03',2),
('DH0020','SP007','M01','SZ02',1),
('DH0002','SP008','M02','SZ01',2),
('DH0003','SP009','M03','SZ03',1),
('DH0004','SP010','M01','SZ02',1),
('DH0005','SP001','M02','SZ03',2),
('DH0006','SP002','M01','SZ01',1),
('DH0007','SP003','M03','SZ01',2),
('DH0008','SP004','M02','SZ02',1),
('DH0009','SP005','M01','SZ01',2),
('DH0010','SP006','M03','SZ01',1),
('DH0011','SP007','M01','SZ03',2)
